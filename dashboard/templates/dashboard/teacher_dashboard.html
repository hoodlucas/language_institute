<!-- dashboard/templates/dashboard/teacher_dashboard.html -->
{% extends "dashboard/layout.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
    <h1>Welcome, {{ teacher.user.first_name }}!</h1>

    <div>
        <a href="{% url 'create_course' %}">üìò Add Course</a> |
        <a href="{% url 'create_class_session' %}">üßë‚Äçüè´ Add Class Session</a>
    </div>

    <h2>Your Courses:</h2>
    {% if courses %}
        <ul>
        {% for course in courses %}
            <li>
                <strong><a href="{% url 'course_sessions' course.id %}">{{ course.name }}</a></strong><br>
                {{ course.description }}<br>
                <em>Schedule:</em>
                <ul>
                    {% for schedule in course.schedules.all %}
                        <li>{{ schedule.day }}: {{ schedule.start_time|time:"H:i" }} - {{ schedule.end_time|time:"H:i" }}</li>
                    {% endfor %}
                </ul>
                <p>
                    <a href="{% url 'edit_course' course.id %}">‚úè Edit</a> |
                    <button onclick="confirmCourseDelete('{{ course.id }}')">üóë Delete</button>
                </p>
                <form id="delete-course-form-{{ course.id }}" method="post" action="{% url 'delete_course' course.id %}" style="display:none;">
                    {% csrf_token %}
                </form>
                <hr>
            </li>
        {% endfor %}
        </ul>
    {% else %}
        <p>You don‚Äôt have any courses yet.</p>
    {% endif %}

    <!-- Modal de confirmaci√≥n para curso -->
    <div id="confirm-course-modal" style="display:none; position:fixed; top:40%; left:50%; transform:translate(-50%,-50%);
        background:white; border:1px solid #ccc; padding:20px; z-index:1000;">
        <p>Are you sure you want to delete this course?</p>
        <button onclick="submitCourseDelete()">Yes, delete</button>
        <button onclick="closeCourseModal()">Cancel</button>
    </div>

    <div id="overlay-course" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%;
        background:rgba(0,0,0,0.5); z-index:999;" onclick="closeCourseModal()"></div>

    <script>
        let courseFormToDelete = null;

        function confirmCourseDelete(courseId) {
            courseFormToDelete = document.getElementById("delete-course-form-" + courseId);
            document.getElementById("confirm-course-modal").style.display = "block";
            document.getElementById("overlay-course").style.display = "block";
        }

        function submitCourseDelete() {
            if (courseFormToDelete) {
                courseFormToDelete.submit();
            }
        }

        function closeCourseModal() {
            document.getElementById("confirm-course-modal").style.display = "none";
            document.getElementById("overlay-course").style.display = "none";
            courseFormToDelete = null;
        }
    </script>
{% endblock %}
